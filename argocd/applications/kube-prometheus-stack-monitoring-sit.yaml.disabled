# ============================================================
# SIT ç›‘æ§ç¯å¢ƒé…ç½® - å·²ç¦ç”¨
# ============================================================
# 
# ğŸ“ å­¦ä¹ è¯´æ˜:
# è¿™ä¸ªæ–‡ä»¶åŒ…å«äº† SIT ç¯å¢ƒçš„å®Œæ•´ç›‘æ§é…ç½®ï¼ŒåŒ…æ‹¬:
# - Prometheus (æŒ‡æ ‡æ”¶é›†)
# - Grafana (å¯è§†åŒ–é¢æ¿)  
# - AlertManager (å‘Šè­¦ç®¡ç†)
# - Node Exporter (èŠ‚ç‚¹ç›‘æ§)
# - Kube State Metrics (K8sçŠ¶æ€ç›‘æ§)
#
# ğŸ”§ å¦‚ä½•å¯ç”¨:
# 1. å°†æ­¤æ–‡ä»¶é‡å‘½åä¸º: kube-prometheus-stack-monitoring-sit.yaml
# 2. ç¡®ä¿ monitoring-sit å‘½åç©ºé—´å­˜åœ¨
# 3. ArgoCD ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶éƒ¨ç½² SIT ç›‘æ§ç¯å¢ƒ
#
# ğŸ’¡ é…ç½®å·®å¼‚ (ç›¸æ¯”DEVç¯å¢ƒ):
# - æ›´é«˜çš„èµ„æºé…ç½® (CPU/å†…å­˜)
# - æ›´é•¿çš„æ•°æ®ä¿ç•™æ—¶é—´ (5å¤© vs 3å¤©)  
# - SITä¸“å±çš„å‘Šè­¦è§„åˆ™é…ç½®
# - ä¸åŒçš„NodePortç«¯å£ (30081)
#
# âš ï¸  å½“å‰çŠ¶æ€: å·²ç¦ç”¨ (èŠ‚çœé›†ç¾¤èµ„æº)
# ============================================================

apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: kube-prometheus-stack-monitoring-sit
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/1979447992/project-gitops-config.git
    targetRevision: main
    path: charts/kube-prometheus-stack
    helm:
      valueFiles:
        - ../../environments/sit/kube-prometheus-stack-values.yaml
  destination:
    server: https://kubernetes.default.svc
    namespace: monitoring-sit
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true
# ============================================================
# SIT ç¯å¢ƒ App of Apps é…ç½®
# ============================================================
# 
# ğŸ“ å­¦ä¹ è¯´æ˜:
# è¿™æ˜¯ SIT ç¯å¢ƒçš„ App of Apps æ¨¡å¼é…ç½®
# ç®¡ç† SIT ç¯å¢ƒçš„æ‰€æœ‰åº”ç”¨ï¼Œé€šè¿‡åˆ†æ”¯å®ç°ç¯å¢ƒéš”ç¦»
#
# ğŸ”§ é…ç½®ç‰¹ç‚¹:
# - ä»…ä» sit åˆ†æ”¯æ‹‰å–é…ç½®
# - éƒ¨ç½²åˆ°æ ‡å‡† argocd å‘½åç©ºé—´
# - ç®¡ç† SIT ç›¸å…³çš„åº”ç”¨å®šä¹‰
#
# ğŸŒŸ åˆ†æ”¯éš”ç¦»ä¼˜åŠ¿:
# - æ¯ä¸ªåˆ†æ”¯è‡ªåŒ…å«å®Œæ•´é…ç½®
# - Gitåˆ†æ”¯å®ç°å¤©ç„¶çš„ç¯å¢ƒéš”ç¦»
# - æ ‡å‡†åŒ–çš„ç›®å½•ç»“æ„
# ============================================================

apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: app-of-apps
  namespace: argocd-sit
spec:
  project: default
  source:
    repoURL: https://github.com/1979447992/project-gitops-config.git
    targetRevision: sit  # Only SIT branch
    path: argocd/applications
  destination:
    server: https://kubernetes.default.svc
    namespace: argocd-sit
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
# ============================================================
# DEV ç¯å¢ƒ App of Apps é…ç½® (ç‹¬ç«‹éƒ¨ç½²æ¨¡å¼)
# ============================================================
# 
# ğŸ“ å­¦ä¹ è¯´æ˜:
# è¿™æ˜¯é‡æ„åçš„ DEV ç¯å¢ƒä¸“ç”¨ App of Apps é…ç½®
# åªç®¡ç† DEV ç¯å¢ƒç›¸å…³çš„åº”ç”¨ï¼Œä¸ SIT ç¯å¢ƒå®Œå…¨åˆ†ç¦»
#
# ğŸ”§ é…ç½®ç‰¹ç‚¹:
# - ä»…ä» dev åˆ†æ”¯æ‹‰å–é…ç½®
# - éƒ¨ç½²åˆ°åŸæœ‰çš„ argocd å‘½åç©ºé—´
# - åªç®¡ç† DEV ç›¸å…³çš„åº”ç”¨å®šä¹‰
#
# ğŸŒŸ é‡æ„ä¼˜åŠ¿:
# - ç¯å¢ƒéš”ç¦»ï¼Œé¿å…äº¤å‰å½±å“
# - åˆ†æ”¯ç­–ç•¥æ¸…æ™°ï¼Œæ˜“äºç®¡ç†
# - ç¬¦åˆä¼ä¸šçº§ GitOps æœ€ä½³å®è·µ
# ============================================================

apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: dev-app-of-apps
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/1979447992/project-gitops-config.git
    targetRevision: dev  # Only DEV branch
    path: argocd/applications
  destination:
    server: https://kubernetes.default.svc
    namespace: argocd
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true